#!/usr/bin/sh

# Change the wallpaper and generate new colorscheme.
# Intakes image path as an only parameter.
# If given a directory, it will open it with sxiv.
# If no arguments, it will open the default directory.
#
# DEPS:
# - sxiv
# - xwallpaper
# - python-wal

[ $# -eq 0 ] && {
    mkdir -p ~/.local/share/wallpapers
    sxiv -tor ~/.local/share/wallpapers
} || {
    [ -d "$1" ] && {
        sxiv -tor "$1"
        exit
    }
    [ -f "$1" ] && {
        # Set the wallpaper
        cp -- "$1" ~/.config/wallpaper
        xwallpaper --zoom ~/.config/wallpaper

        # Clear cache before generating, because for some reason
        # pywal sometimes doesn't notice background changes
        wal -c
        wal -i ~/.config/wallpaper -neqst

        # Apply the new colorscheme
        ~/.scripts/pywal_to_xres
    }
}

